<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.210">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Matt Crump">
<meta name="dcterms.date" content="2022-05-17">
<meta name="description" content="An attempt to blog with pkgdown, including notes to self about how I did this. It was succesful enough that I’m using pkgdown for this blog.">

<title>crumplab - Blogging with pkgdown?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HPGGT4QZ8Q"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-HPGGT4QZ8Q', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="crumplab - Blogging with pkgdown?">
<meta property="og:description" content="An attempt to blog with pkgdown, including notes to self about how I did this. It was succesful enough that I'm using pkgdown for this blog.">
<meta property="og:image" content="imgs/blogging_with_pkgdown.jpg">
<meta property="og:site-name" content="crumplab">
<meta name="twitter:title" content="crumplab - Blogging with pkgdown?">
<meta name="twitter:description" content="An attempt to blog with pkgdown, including notes to self about how I did this. It was succesful enough that I'm using pkgdown for this blog.">
<meta name="twitter:image" content="imgs/blogging_with_pkgdown.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">crumplab</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../People.html">
 <span class="menu-text">People</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Publications.html">
 <span class="menu-text">Pubs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Books.html">
 <span class="menu-text">Books and OERs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Courses.html">
 <span class="menu-text">Courses</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Apps.html">
 <span class="menu-text">Apps</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Opportunities.html">
 <span class="menu-text">Join</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Blog.html">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Fun.html">
 <span class="menu-text">Fun</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/CrumpLab"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/MattCrumpLab"><i class="bi bi-twitter" role="img" aria-label="Twitter">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/c/CrumpsComputationalCognitionLab"><i class="bi bi-youtube" role="img" aria-label="Youtube">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#blogging-features-im-looking-for" id="toc-blogging-features-im-looking-for" class="nav-link active" data-scroll-target="#blogging-features-im-looking-for">Blogging features I’m looking for</a></li>
  <li><a href="#implementing-the-blog-in-pkgdown" id="toc-implementing-the-blog-in-pkgdown" class="nav-link" data-scroll-target="#implementing-the-blog-in-pkgdown">Implementing the blog in pkgdown</a>
  <ul class="collapse">
  <li><a href="#make-a-blog-folder-in-vignettes" id="toc-make-a-blog-folder-in-vignettes" class="nav-link" data-scroll-target="#make-a-blog-folder-in-vignettes">Make a blog folder in vignettes</a></li>
  <li><a href="#post-workflow" id="toc-post-workflow" class="nav-link" data-scroll-target="#post-workflow">Post workflow</a></li>
  </ul></li>
  <li><a href="#compiling-the-posts-using-build_articles" id="toc-compiling-the-posts-using-build_articles" class="nav-link" data-scroll-target="#compiling-the-posts-using-build_articles">Compiling the posts using build_articles()</a></li>
  <li><a href="#ordering-posts-from-newest-to-oldest" id="toc-ordering-posts-from-newest-to-oldest" class="nav-link" data-scroll-target="#ordering-posts-from-newest-to-oldest">Ordering posts from newest to oldest</a>
  <ul class="collapse">
  <li><a href="#helper-functions" id="toc-helper-functions" class="nav-link" data-scroll-target="#helper-functions">helper functions</a></li>
  </ul></li>
  <li><a href="#custom-stuff" id="toc-custom-stuff" class="nav-link" data-scroll-target="#custom-stuff">Custom stuff</a></li>
  <li><a href="#issues" id="toc-issues" class="nav-link" data-scroll-target="#issues">Issues</a></li>
  <li><a href="#extra-bits" id="toc-extra-bits" class="nav-link" data-scroll-target="#extra-bits">Extra bits</a>
  <ul class="collapse">
  <li><a href="#drafting-a-post-without-publishing" id="toc-drafting-a-post-without-publishing" class="nav-link" data-scroll-target="#drafting-a-post-without-publishing">Drafting a post without publishing</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Blogging with pkgdown?</h1>
</div>

<div>
  <div class="description">
    An attempt to blog with pkgdown, including notes to self about how I did this. It was succesful enough that I’m using pkgdown for this blog.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Matt Crump </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 17, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<style type="text/css">
@media (min-width: 1400px) {
    body {
        font-size:18px
    }

    .col-md-3 {
        margin-left: 5rem
    }
    
    .row {
        --bs-gutter-x: -20%!important;
    }
    
    .row>main {
        max-width: 40rem;
    }

}

</style>
<div class="cell">
<div class="cell-output-display">
<p><img src="imgs/blogging_with_pkgdown.jpg" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Last knit: 2022-10-14</p>
<p><strong>NOTE: I stopped using pkgdown for bloggin and switched to <a href="https://quarto.org/docs/websites/website-blog.html">quarto</a>, which is much better suited to the task</strong>.</p>
<p>I like <a href="https://pkgdown.r-lib.org">pkgdown</a>. It’s great for what it was built to do (make websites for R packages), and it’s pretty good at other use cases as well. For example, I recently re-factored my lab webpage using pkgdown and that worked out well enough.</p>
<p>My previous website had a hacked together blog using demented combinations of R markdown templates. I was thinking about adopting some other blogging scheme like <a href="https://rstudio.github.io/distill/">distill</a>, but couldn’t get it to play nice with pkgdown. So, this is an attempt to blog in pkgdown and see how far that goes for me.</p>
<section id="blogging-features-im-looking-for" class="level2">
<h2 class="anchored" data-anchor-id="blogging-features-im-looking-for">Blogging features I’m looking for</h2>
<p>Here’s of list of features I think I want for blogging. Making this list should help me figure out whether or not I can implement them in pkgdown.</p>
<ol type="1">
<li>Have an index page that lists all of the blog posts, and that is auto-magically generated from the blog posts</li>
<li>Have a “make_post()” type of function that makes a template for a new post all ready to go, and saved in the folder where it needs to be.</li>
<li>Have the posts be searchable in pkgdown</li>
<li>Have the posts use the same site-wide navigation as the rest of the site.</li>
</ol>
</section>
<section id="implementing-the-blog-in-pkgdown" class="level2">
<h2 class="anchored" data-anchor-id="implementing-the-blog-in-pkgdown">Implementing the blog in pkgdown</h2>
<p>I think I can do most of what I want with pkgdown vignettes. One minor detail is that I’m not sure how easy it will be to customize the index page listing all of the blog posts. It would be nice to have a picture for each blog post, but that might not be an option without some meddling. Oh well. I’ll use the rest of this post to leave breadcrumbs for my future self on a blogging workflow.</p>
<section id="make-a-blog-folder-in-vignettes" class="level3">
<h3 class="anchored" data-anchor-id="make-a-blog-folder-in-vignettes">Make a blog folder in vignettes</h3>
<p>Pkgdown automatically renders .Rmd files in the vignettes folder. I already have the main pages of the website in vignettes, so I’ll make a separate folder called <code>vignettes/blog</code> to hold all of the blog posts.</p>
</section>
<section id="post-workflow" class="level3">
<h3 class="anchored" data-anchor-id="post-workflow">Post workflow</h3>
<p>I need to make some decisions here. Should I put individual vignettes in the blog folder, or should I make subdirectories for each post. What are the naming conventions?</p>
<p>This kind of structure might work. But, I need to check how the posts are rendered to the articles page.</p>
<pre><code>vignettes/blog
├── post_4_1_22_older_post
│   └── post_4_1_22_older_post.Rmd
└── post_5_17_22_blogging
    └── post_5_17_22_blogging.Rmd</code></pre>
</section>
</section>
<section id="compiling-the-posts-using-build_articles" class="level2">
<h2 class="anchored" data-anchor-id="compiling-the-posts-using-build_articles">Compiling the posts using build_articles()</h2>
<p><code>pkgdown::build_articles()</code> will compile all of the .Rmds in the vignettes folder. The blog posts are in there, so they will be compiled to.</p>
<p>The same function also creates an <code>index.html</code> for the knitted vignettes. My plan is to use that page to list only blog posts, and not any other pages I have in the vignettes folder. This can be accomplished through <code>_pkgdown.yml</code>.</p>
<p>For example, the following creates some sections on the index.html, and uses <code>starts_with()</code> to loop through folders that start with <code>post</code> in the <code>blog</code> folder.</p>
<pre><code>articles:
- title: Newer Posts
  desc: Trying out blogging with pkgdown.
  navbar: ~
  contents:
  - starts_with("blog/post")
- title: Older Posts
  desc: Need to add links to older stuff here...
  navbar: ~</code></pre>
</section>
<section id="ordering-posts-from-newest-to-oldest" class="level2">
<h2 class="anchored" data-anchor-id="ordering-posts-from-newest-to-oldest">Ordering posts from newest to oldest</h2>
<p>If I adopt the above naming convention <code>post_M_D_Y_title</code>, then posts get listed from oldest to newest on the index page. Need to flip that.</p>
<p>It seems like I would just need to sort the order of posts somehow, but I couldn’t figure that out.</p>
<p>I could use a naming convention with a number that gets smaller for every new post <code>post_number_M_D_Y_title</code>. That’s mildly annoying, but probably what I will do for now. Another option would be to override the _pkgdown.yml while running <code>build_articles()</code>. But this would require writing an alternative yml that lists the contents in a preferred order. That seems like too much work.</p>
<p>Decision was to start at 999, and count down. I probably won’t get to 0, and if I do, well that’s on me.</p>
<pre><code>vignettes/blog
├── post_998_5_17_22_blogging
│   └── post_998_5_17_22_blogging.Rmd
└── post_999_3_1_22_older_post
    └── post_999_3_1_22_older_post.Rmd</code></pre>
<section id="helper-functions" class="level3">
<h3 class="anchored" data-anchor-id="helper-functions">helper functions</h3>
<p>Not sure that I need any helper functions. I was thinking about creating a <code>make_post</code> function in the spirit of <code>usethis:use_vignette()</code>. Maybe I’ll try that later. For now it wouldn’t be too bad to just copy/paste and reword stuff from a previous blog post.</p>
</section>
</section>
<section id="custom-stuff" class="level2">
<h2 class="anchored" data-anchor-id="custom-stuff">Custom stuff</h2>
<p>I have a bunch of older blog pieces. I should consider migrating them over. Before I do that I should at least link to them.</p>
<p>I had fun adding banners to other pages on my lab website, and I would like to add a banner to the articles index.html to spice things up. Not sure yet how to do this…maybe an override with includes before body or something. I tried an override, but the outcome wasn’t pretty.</p>
<p>Next up is to hack the template. Looks like I need to make a template off of <code>content-article-index.html</code>.</p>
<ul>
<li>Make <code>inst/pkgdown/BS5/templates</code></li>
<li>copy in <code>content-article-index.html</code> from pkgdown templates</li>
<li>create a dummy R package for this repo, it’s called crumplab</li>
<li>list crumplab as package in template yml listing in <code>_pkgdown.yml</code></li>
<li>mod <code>content-article-index.html</code> and add my images etc.</li>
</ul>
<p>It worked I think. Note to self that the package needs to be rebuilt in order for any changes to the templates to take effect.</p>
</section>
<section id="issues" class="level2">
<h2 class="anchored" data-anchor-id="issues">Issues</h2>
<p>I want to add unique twitter cards to the <code>articles/index.html</code> page, and to individual posts. I thought this would be easy, because <code>pkgdown</code> makes it easy to <a href="https://pkgdown.r-lib.org/articles/metadata.html?q=twitter#article-metadata">add twitter cards for each vignette</a>. However, it seems that any other cards are added on a site-wide basis, and defined in <code>_pkgdown.yml</code>. Additionally, it’s not clear how to set individual cards for pages like <code>articles/index.html</code>.</p>
<p>Solution was to write a custom version of <code>pkgdown::build_article_index()</code> that allowed to the override to be applied only to <code>articles/index.html</code>, and not to any the blog posts. A nice side effect was that I was planning to add some functions to a lab R package, so now I can put those in the R package for the crumplab website.</p>
</section>
<section id="extra-bits" class="level2">
<h2 class="anchored" data-anchor-id="extra-bits">Extra bits</h2>
<p>So far I’m pretty happy with this approach to blogging. But, I’m sure there’s a bunch of things that will come up as I try to process out even more. I’m going to use the space to make breadcrumbs for myself to solve little blogging problems that I stumble across.</p>
<section id="drafting-a-post-without-publishing" class="level3">
<h3 class="anchored" data-anchor-id="drafting-a-post-without-publishing">Drafting a post without publishing</h3>
<p>What are some options for drafting a post and choosing when to publish it.</p>
<ol type="1">
<li>Make a new post on my local computer and don’t push it to Github.</li>
<li>Add to <code>.Rbuildignore</code>, but this wouldn’t allow a preview?</li>
<li>Or, add new posts to a <code>blog/drafts</code> folder. This should build the post, but it won’t be linked to on the blog page. If someone knew the URL it would still be visible on the internet, if pushed to github.</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>